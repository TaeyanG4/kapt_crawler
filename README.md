# K-APT 크롤러

K-APT 크롤러는 [한국 공동주택관리정보시스템(K-APT)](https://www.k-apt.go.kr)에서 공개되는 아파트 관련 입찰 및 계약 정보를 자동으로 수집하는 도구입니다. 사업자 선정 결과, 입찰 공고 등의 정보를 쉽게 수집하고 분석할 수 있습니다.

## 기능 소개

- **다양한 K-APT 데이터 수집**
  - 사업자 선정(수의계약) 결과 공개
  - 사업자 선정(경쟁입찰) 결과 공개
  - 전국 입찰공고

- **유연한 크롤링 모드**
  - **전체 페이지 + 상세정보 크롤링**: 목록과 각 항목의 상세정보를 함께 수집
  - **전체 페이지만 크롤링**: 목록 데이터만 빠르게 수집
  - **상세정보만 크롤링**: 이미 가지고 있는 엑셀 파일의 링크를 통해 상세정보 추가 수집

- **편리한 사용자 인터페이스**
  - 직관적인 GUI로 쉽게 크롤링 설정 가능
  - 실시간 로그로 진행 상황 확인
  - 설정 저장 및 불러오기 기능

- **고급 기능**
  - 설정 파일을 이용한 일괄 크롤링 기능
  - 선택적 상세 정보 크롤링으로 필요한 데이터만 수집
  - 작업 완료 후 자동 종료 기능
  - 명령줄(CLI) 모드 지원으로 자동화 가능

## 설치 방법

### 방법 1: 실행 파일 다운로드 (권장)

1. [GitHub Releases](https://github.com/TaeyanG4/kapt_crawler/releases)에서 최신 버전의 exe 파일을 다운로드합니다.
2. 다운로드한 `kapt_crawler.exe` 파일을 실행합니다.

### 방법 2: 소스코드로 실행

1. 이 저장소를 클론합니다:
   ```bash
   git clone https://github.com/TaeyanG4/kapt_crawler.git
   cd kapt_crawler
   ```

2. 필요한 패키지를 설치합니다:
   ```bash
   pip install -r requirements.txt
   ```

3. 프로그램을 실행합니다:
   ```bash
   python main.py
   ```

## 요구사항

- 실행 파일 사용 시: Windows 7/10/11
- 소스코드 실행 시: Python 3.6 이상 및 다음 패키지:
  - requests
  - beautifulsoup4
  - lxml
  - pandas
  - openpyxl
  - PyQt5

## 사용 방법

### GUI 모드 기본 사용법

1. **크롤링 기본 설정**
   - 크롤링할 URL을 입력합니다. (빈 칸이면 기본 URL 사용)
   - 추출할 데이터 건수를 설정합니다.

2. **크롤링 모드 선택**
   - 전체 페이지 + 상세정보: 목록과 상세정보 모두 수집
   - 전체 페이지만: 목록 정보만 수집
   - 기존 엑셀 -> 상세정보만: 이미 가지고 있는 목록 데이터에서 상세 정보만 추가 수집

3. **페이지 유형 선택**
   - 사업자 선정(수의계약) 결과 공개
   - 사업자 선정(경쟁입찰) 결과 공개
   - 전국 입찰공고

4. **상세 컬럼 선택**
   - 필요한 상세 정보 항목만 선택하여 크롤링할 수 있습니다.
   - 선택하지 않은 항목은 수집되지 않습니다.

5. **크롤링 시작**
   - 설정이 완료되면 "크롤링 시작" 버튼을 클릭합니다.
   - 진행 상황은 로그 창에 실시간으로 표시됩니다.

### 명령줄(CLI) 모드 사용법

프로그램을 명령줄에서 다음과 같이 사용할 수 있습니다:

```bash
# GUI 모드로 실행
python main.py

# 도움말 표시
python main.py help

# 설정 파일을 사용하여 CLI 모드로 크롤링 실행
python main.py 설정파일.json
```

또는 exe 파일을 사용하는 경우:

```bash
# GUI 모드로 실행
kapt_crawler.exe

# 도움말 표시
kapt_crawler.exe help

# 설정 파일을 사용하여 CLI 모드로 크롤링 실행
kapt_crawler.exe 설정파일.json
```

#### JSON 설정 파일 구조

CLI 모드에서는 다음 형식의 JSON 설정 파일을 사용합니다:

```json
{
  "url": "https://www.k-apt.go.kr/...",
  "extraction_count": 50,
  "mode": 1,
  "page_type_index": 0,
  "selected_excel_path": "",
  "selected_detail_columns": ["단지명", "계약업체", "계약명", "...]
}
```

설정 항목 설명:
- `url`: 크롤링할 URL (빈 문자열이면 기본 URL 사용)
- `extraction_count`: 추출할 데이터 건수
- `mode`: 크롤링 모드 (1: 전체+상세, 2: 전체만, 3: 상세정보만)
- `page_type_index`: 페이지 유형 (0: 수의계약, 1: 경쟁입찰, 2: 입찰공고)
- `selected_excel_path`: 기존 엑셀 파일 경로 (모드 3에서 사용)
- `selected_detail_columns`: 수집할 상세 컬럼 목록

### 고급 사용법

#### 설정 저장 및 불러오기

- **설정 저장**: 현재 설정을 JSON 파일로 저장하여 나중에 재사용할 수 있습니다.
- **설정 불러오기**: 저장된 설정 파일을 불러와 빠르게 동일한 설정으로 크롤링할 수 있습니다.

#### 폴더 기반 일괄 크롤링

1. 여러 개의 설정 파일(JSON)을 특정 폴더에 저장합니다.
2. "폴더 설정 크롤링 실행" 버튼을 클릭합니다.
3. 해당 폴더를 선택하면 각 설정 파일에 따라 연속적으로 크롤링을 수행합니다.
4. 모든 작업이 완료되면 알림을 표시합니다.

#### 크롤링 완료 후 자동 종료

- "설정" 메뉴에서 "크롤링 완료 후 자동 종료" 옵션을 활성화하면, 작업이 끝난 후 프로그램이 자동으로 종료됩니다.
- 배치 작업을 자동화할 때 유용한 기능입니다.

#### 자동화 팁

- 윈도우 작업 스케줄러와 CLI 모드를 조합하여 정기적인 크롤링 작업을 자동화할 수 있습니다.
- 예: `kapt_crawler.exe C:\settings\daily_crawl.json`을 작업 스케줄러에 등록

## 출력 결과

- **추출데이터 폴더**: 목록 데이터만 크롤링한 결과가 저장됩니다.
- **추출데이터_상세정보 폴더**: 상세 정보를 포함한 크롤링 결과가 저장됩니다.
- 모든 파일은 엑셀(.xlsx) 형식으로 저장되며, 파일명에는 타임스탬프가 포함됩니다.

## 문제 해결

1. **크롤링이 진행되지 않는 경우**
   - URL이 올바른지 확인하세요.
   - 페이지 유형 선택이 URL과 일치하는지 확인하세요.
   - 네트워크 연결 상태를 확인하세요.

2. **상세정보가 수집되지 않는 경우**
   - 상세정보 링크가 올바른지 확인하세요.
   - 크롤링할 상세 컬럼이 선택되어 있는지 확인하세요.

3. **프로그램이 응답하지 않는 경우**
   - 대량의 데이터를 크롤링할 때는 시간이 오래 걸릴 수 있습니다.
   - 로그 창에서 진행 상황을 확인하세요.
   - 크롤링 갯수를 줄이고 다시 시도해보세요.

4. **CLI 모드 오류**
   - JSON 파일 형식이 올바른지 확인하세요.
   - 경로나 파일명에 공백이나 특수문자가 있으면 따옴표로 감싸세요.

## 라이선스

이 프로젝트는 MIT 라이선스 하에 배포됩니다. 자세한 내용은 LICENSE 파일을 참조하세요.

## 면책 조항

- 본 소프트웨어는 K-APT 공개 정보를 수집하는 목적으로 제작되었습니다.
- 수집한 데이터의 사용은 사용자의 책임하에 이루어져야 합니다.
- 과도한 크롤링은 해당 웹사이트의 서비스에 부담을 줄 수 있으므로, 적절한 간격과 양을 유지하여 사용하세요.
- 수집한 데이터의 정확성은 원본 웹사이트의 정보에 의존합니다.

## 기여 방법

버그 리포트, 기능 요청 또는 코드 기여를 환영합니다. 자유롭게 이슈를 등록하거나 풀 리퀘스트를 보내주세요.

## 연락처

문의사항이나 피드백이 있으시면 taeyang95@naver.com 또는 GitHub 이슈를 통해 연락해 주세요.

---

**주의**: 본 프로그램은 공개된 정보를 수집하는 도구이나, 사용 시 웹사이트의 이용 약관과 정책을 준수해야 합니다.